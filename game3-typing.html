<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sentence Typing - Hebrew Practice</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            width: 100%;
            max-width: 900px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
            padding: 40px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .stat-label {
            font-size: 0.7em;
            opacity: 0.8;
            display: block;
            font-weight: normal;
        }

        .sentence-display {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 10px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sentence-text {
            font-size: 1.8em;
            line-height: 1.6;
            color: #2c3e50;
            text-align: center;
            user-select: none;
        }

        .translation-display {
            background: #e8f4f8;
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }

        .translation-text {
            font-size: 1em;
            color: #555;
            font-style: italic;
            line-height: 1.5;
        }

        .translation-label {
            font-size: 0.85em;
            color: #888;
            margin-right: 8px;
            font-weight: bold;
        }

        .char {
            display: inline-block;
            padding: 2px;
        }

        .char.correct {
            color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
        }

        .char.incorrect {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.2);
        }

        .char.current {
            background: #667eea;
            color: white;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.5; }
        }

        .input-area {
            margin-bottom: 30px;
        }

        .typing-input {
            width: 100%;
            padding: 20px;
            font-size: 1.5em;
            border: 3px solid #667eea;
            border-radius: 15px;
            font-family: inherit;
            direction: rtl;
            outline: none;
            transition: border-color 0.3s;
        }

        .typing-input:focus {
            border-color: #764ba2;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .progress-bar {
            background: #e0e0e0;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 35px;
            font-size: 1.2em;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(102, 126, 234, 0.6);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .secondary-btn {
            background: #95a5a6;
            box-shadow: 0 5px 15px rgba(149, 165, 166, 0.4);
        }

        .secondary-btn:hover {
            box-shadow: 0 7px 20px rgba(149, 165, 166, 0.6);
        }

        .game-over, .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
            overflow-y: auto;
            padding: 20px 10px;
        }

        .game-over.hidden, .start-screen.hidden {
            display: none;
        }

        .game-over h1, .start-screen h1 {
            color: white;
            font-size: 3em;
            margin-bottom: 30px;
        }

        .stats-summary {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            min-width: 400px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            color: white;
            font-size: 1.3em;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: rgba(255,255,255,0.8);
        }

        .stat-value {
            font-weight: bold;
            color: #667eea;
            background: white;
            padding: 5px 15px;
            border-radius: 10px;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            color: #667eea;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 20px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .lang-selector {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            gap: 8px;
            z-index: 2000;
            background: rgba(255, 255, 255, 0.95);
            padding: 8px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .lang-btn {
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid transparent;
            padding: 6px 12px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: bold;
            color: #667eea;
            transition: all 0.3s ease;
        }

        .lang-btn:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .lang-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        @media (max-width: 768px) {
            .back-btn {
                top: 10px;
                right: 10px;
                padding: 8px 15px;
                font-size: 0.9em;
            }

            .lang-selector {
                top: 10px;
                left: 10px;
                gap: 5px;
                padding: 6px;
            }

            .lang-btn {
                padding: 5px 8px;
                font-size: 0.7em;
            }
        }

        .instructions {
            color: white;
            text-align: center;
            max-width: 600px;
            line-height: 1.8;
            margin-bottom: 30px;
            font-size: 1.2em;
        }

        .difficulty-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        .difficulty-btn {
            flex: 1;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border: 2px solid transparent;
            color: white;
            font-size: 1.1em;
        }

        .difficulty-btn.selected {
            background: rgba(255,255,255,0.3);
            border-color: white;
        }

        @media (max-width: 768px) {
            body {
                padding: 0;
                overflow-x: hidden;
                align-items: flex-start;
            }

            h1 {
                font-size: 2em;
            }

            .game-container {
                padding: 10px;
                min-height: 100vh;
                min-height: 100dvh; /* Dynamic viewport height for mobile */
                display: flex;
                flex-direction: column;
                border-radius: 0;
            }

            .header {
                flex-wrap: wrap;
                gap: 5px;
                margin-bottom: 10px;
            }

            .stat-box {
                font-size: 0.85em;
                padding: 8px 12px;
                flex: 1 1 45%;
            }

            .stat-label {
                font-size: 0.65em;
            }

            .progress-bar {
                height: 20px;
                margin-bottom: 10px;
            }

            .sentence-display {
                padding: 15px 10px;
                margin-bottom: 10px;
                min-height: 100px;
                max-height: none;
                overflow-y: visible;
                position: sticky;
                top: 0;
                z-index: 20;
                background: #f8f9fa;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }

            .sentence-text {
                font-size: 1.3em;
                line-height: 1.5;
            }

            .translation-display {
                padding: 8px 10px;
                margin-bottom: 10px;
            }

            .translation-text {
                font-size: 0.75em;
                line-height: 1.3;
            }

            .input-area {
                margin-bottom: 10px;
                position: sticky;
                bottom: 0;
                background: white;
                padding: 10px 0;
                z-index: 15;
                box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            }

            .typing-input {
                font-size: 16px; /* Prevents iOS zoom */
                padding: 15px;
            }

            .actions {
                flex-direction: row;
                gap: 8px;
                margin-top: auto;
            }

            button {
                flex: 1;
                padding: 10px 15px;
                font-size: 0.95em;
            }

            .stats-summary {
                min-width: auto;
                width: 95%;
                padding: 20px;
            }

            .stat-row {
                font-size: 1.1em;
                flex-direction: column;
                text-align: center;
                gap: 5px;
            }

            .start-screen h1 {
                font-size: 1.5em;
                margin-bottom: 10px;
            }

            .instructions {
                font-size: 0.85em;
                line-height: 1.4;
                margin-bottom: 10px;
            }

            .instructions p {
                margin-bottom: 5px;
            }

            .difficulty-selector {
                flex-direction: row;
                gap: 10px;
                margin-bottom: 10px;
            }

            .difficulty-btn {
                width: auto;
                flex: 1;
                padding: 10px;
                font-size: 0.9em;
            }
        }

        /* Fix for iOS keyboard - when keyboard is open, viewport height is reduced */
        @media (max-width: 768px) and (max-height: 600px) {
            .header {
                margin-bottom: 5px;
            }

            .stat-box {
                font-size: 0.7em;
                padding: 5px 8px;
            }

            .progress-bar {
                height: 15px;
                margin-bottom: 5px;
            }

            .sentence-display {
                padding: 10px;
                min-height: 70px;
                margin-bottom: 5px;
            }

            .sentence-text {
                font-size: 1.1em;
                line-height: 1.3;
            }

            .translation-display {
                padding: 5px 10px;
                margin-bottom: 5px;
            }

            .translation-text {
                font-size: 0.7em;
            }

            .input-area {
                padding: 5px 0;
            }

            .typing-input {
                padding: 10px;
            }

            .actions {
                margin-top: 5px;
            }

            button {
                padding: 8px 12px;
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body>
    <!-- Language Selector -->
    <div class="lang-selector">
        <button class="lang-btn active" data-lang="he" onclick="setLanguage('he')"> 注专转</button>
        <button class="lang-btn" data-lang="en" onclick="setLanguage('en')"> English</button>
        <button class="lang-btn" data-lang="fr" onclick="setLanguage('fr')"> Fran莽ais</button>
    </div>

    <a href="index.html" class="back-btn"><span data-i18n="common.back">专</span></a>
    
    <div class="start-screen" id="startScreen">
        <h1>
            <span class="lang-he" data-i18n="game3.title">锔 拽转 砖驻 注专转</span>
            <span class="lang-en" data-i18n="game3.title">锔 Hebrew Sentence Typing</span>
            <span class="lang-fr" data-i18n="game3.title">锔 Frappe de phrases h茅bra茂ques</span>
        </h1>
        <div class="instructions">
            <p class="lang-he"><strong data-i18n="game3.inst1">转专 拽 专 拽转 注 砖驻 注转 注专!</strong></p>
            <p class="lang-en"><strong data-i18n="game3.inst1">Practice fast and accurate typing with Hebrew newspaper sentences!</strong></p>
            <p class="lang-fr"><strong data-i18n="game3.inst1">Pratiquez la frappe rapide et pr茅cise avec des phrases de journaux h茅breux !</strong></p>
            
            <p class="lang-he"><strong data-i18n="game3.inst2">拽 转 砖驻 爪 拽  驻砖专.</strong></p>
            <p class="lang-en"><strong data-i18n="game3.inst2">Type the displayed sentence as accurately as possible.</strong></p>
            <p class="lang-fr"><strong data-i18n="game3.inst2">Tapez la phrase affich茅e aussi pr茅cis茅ment que possible.</strong></p>
            
            <p class="lang-he"><strong data-i18n="game3.inst3">转拽 拽 注 住住 专转 拽.</strong></p>
            <p class="lang-en"><strong data-i18n="game3.inst3">You'll receive points based on speed and accuracy.</strong></p>
            <p class="lang-fr"><strong data-i18n="game3.inst3">Vous recevrez des points en fonction de la vitesse et de la pr茅cision.</strong></p>
        </div>
        <div class="difficulty-selector">
            <button class="difficulty-btn selected" onclick="selectDifficulty('easy')"><span class="lang-he" data-i18n="game3.easy">拽</span><span class="lang-en" data-i18n="game3.easy">Easy</span><span class="lang-fr" data-i18n="game3.easy">Facile</span></button>
            <button class="difficulty-btn" onclick="selectDifficulty('medium')"><span class="lang-he" data-i18n="game3.medium"></span><span class="lang-en" data-i18n="game3.medium">Medium</span><span class="lang-fr" data-i18n="game3.medium">Moyen</span></button>
            <button class="difficulty-btn" onclick="selectDifficulty('hard')"><span class="lang-he" data-i18n="game3.hard">拽砖</span><span class="lang-en" data-i18n="game3.hard">Hard</span><span class="lang-fr" data-i18n="game3.hard">Difficile</span></button>
        </div>
        <button onclick="startGame()" data-i18n="common.startGame">转 砖拽</button>
    </div>

    <div class="game-container">
        <div class="header">
            <div class="stat-box"><span class="lang-he" data-i18n="game3.sentence">砖驻:</span><span class="lang-en" data-i18n="game3.sentence">Sentence:</span><span class="lang-fr" data-i18n="game3.sentence">Phrase :</span> <span id="sentenceNum">0</span>/10</div>
            <div class="stat-box"><span class="lang-he" data-i18n="game3.accuracy">拽:</span><span class="lang-en" data-i18n="game3.accuracy">Accuracy:</span><span class="lang-fr" data-i18n="game3.accuracy">Pr茅cision :</span> <span id="accuracy">100</span>%</div>
            <div class="stat-box"><span class="lang-he" data-i18n="common.speed">专转:</span><span class="lang-en" data-i18n="common.speed">Speed:</span><span class="lang-fr" data-i18n="common.speed">Vitesse :</span> <span id="wpm">0</span> WPM</div>
            <div class="stat-box"><span class="lang-he" data-i18n="common.score">拽:</span><span class="lang-en" data-i18n="common.score">Score:</span><span class="lang-fr" data-i18n="common.score">Score :</span> <span id="score">0</span></div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%">
                <span id="progressText">0%</span>
            </div>
        </div>

        <div class="sentence-display">
            <div class="sentence-text" id="sentenceDisplay">
                <span class="lang-he" data-i18n="game3.pressStart">抓 "转"  转</span>
                <span class="lang-en" data-i18n="game3.pressStart">Press "Start" to begin</span>
                <span class="lang-fr" data-i18n="game3.pressStart">Appuyez sur "D茅marrer" pour commencer</span>
            </div>
        </div>

        <div class="translation-display" id="translationDisplay">
            <div class="translation-text">
                <span class="translation-label"></span><span id="englishTranslation"></span><br>
                <span class="translation-label"></span><span id="frenchTranslation"></span><br>
                <span class="translation-label">锔</span><span id="keyboardHint" style="font-family: monospace; color: #667eea;">-</span>
            </div>
        </div>

        <div class="input-area">
            <input 
                type="text" 
                class="typing-input" 
                id="typingInput" 
                data-i18n-placeholder="game3.placeholder"
                placeholder="拽 转 砖驻 ..."
                disabled
            >
        </div>

        <div class="actions">
            <button onclick="startGame()" id="startBtn" data-i18n="common.start">转</button>
            <button onclick="skipSentence()" id="skipBtn" disabled data-i18n="common.skip"></button>
            <button onclick="resetGame()" class="secondary-btn" data-i18n="common.restart">转 砖</button>
        </div>
    </div>

    <div class="game-over hidden" id="gameOver">
        <h1>
            <span class="lang-he" data-i18n="common.wellDone"> ! </span>
            <span class="lang-en" data-i18n="common.wellDone"> Well Done!</span>
            <span class="lang-fr" data-i18n="common.wellDone"> Bien jou茅 !</span>
        </h1>
        <div class="stats-summary">
            <div class="stat-row">
                <span class="lang-he" data-i18n="game3.completed">砖驻 砖砖:</span>
                <span class="lang-en" data-i18n="game3.completed">Completed:</span>
                <span class="lang-fr" data-i18n="game3.completed">Compl茅t茅es :</span>
                <span class="stat-value"><span id="finalSentences">0</span>/10</span>
            </div>
            <div class="stat-row">
                <span class="lang-he" data-i18n="game3.accuracy">拽 :</span>
                <span class="lang-en" data-i18n="game3.accuracy">Accuracy:</span>
                <span class="lang-fr" data-i18n="game3.accuracy">Pr茅cision :</span>
                <span class="stat-value"><span id="finalAccuracy">0</span>%</span>
            </div>
            <div class="stat-row">
                <span class="lang-he" data-i18n="game3.avgSpeed">专转 爪注转:</span>
                <span class="lang-en" data-i18n="game3.avgSpeed">Avg Speed:</span>
                <span class="lang-fr" data-i18n="game3.avgSpeed">Vitesse moyenne :</span>
                <span class="stat-value"><span id="finalWpm">0</span> WPM</span>
            </div>
            <div class="stat-row">
                <span class="lang-he" data-i18n="game3.finalScore">拽 住驻:</span>
                <span class="lang-en" data-i18n="game3.finalScore">Final Score:</span>
                <span class="lang-fr" data-i18n="game3.finalScore">Score final :</span>
                <span class="stat-value"><span id="finalScore">0</span></span>
            </div>
        </div>
        <button onclick="restartGame()" data-i18n="common.playAgain">砖拽 砖</button>
    </div>

    <script src="localization.js"></script>
    <script>
        // Hebrew sentences from various topics (news-style)
        const sentences = {
            easy: [
                "砖砖 专转 砖 ",
                " 砖拽  爪专",
                " 专抓 专转 专",
                "   驻专转 专",
                "专 转 转 转",
                "住驻专 爪 注 砖",
                " 拽专 爪",
                "注抓  驻 ",
                "爪驻专 砖专 拽专",
                "转 砖 注 专住",
                "驻专 驻专 ",
                " 砖转 专转 注专 注",
                " 拽专 注转 住",
                "住 注  转",
                "转 砖  ",
                "转 砖  专",
                "  转 住驻专 专",
                "专 专  砖",
                "砖 专 抓 注爪",
                "专 砖 专 专 砖"
            ],
            medium: [
                "砖 砖 专 注 转转 转 拽驻",
                "注   转 砖 注专转 砖砖",
                "转转  专  砖砖  住祝 砖注",
                "砖 驻砖 注  转 砖转",
                "专转  砖专转 住  专",
                "专驻 爪 注 专  专 驻注",
                "注专 转转 转 驻专拽 爪专 砖 专",
                "住驻专 砖专  转 驻",
                "专住 驻转转 转转  砖",
                "转注砖转 -拽 砖专转 砖 爪",
                "住 驻 拽驻住  注转 砖专 ",
                " 爪 转注专 砖 砖 转 专转",
                "砖专 转专 注 注 专转 拽 专转 爪驻",
                "专 砖专 转  专转 专",
                "砖驻转 转  砖驻转 专 ",
                "转 砖 专转 爪专 拽专拽 专 ",
                "转专 拽专 专砖 转  住驻专 ",
                " 专 注 砖 专 专",
                "爪  驻专住  注 注转 爪转",
                "驻住 砖转 砖 砖砖  爪注 砖"
            ],
            hard: [
                "住转 砖专 转 拽专 专砖 转 爪注转 拽 砖 拽转",
                "砖专 专转 驻专住 转 砖 注 注 注 住驻专 ",
                "砖 转  爪 砖 专 砖砖 砖注转  转拽转 砖注转转",
                "拽专 专住 注专转 驻转  砖转 驻 转",
                "专住 专转 注专 住 转 住专 专 砖 砖砖 ",
                "专砖 砖 注 注 拽转 注转 拽专 转转 拽转 专注",
                "砖专  转 专驻专 拽驻 注专转  砖专转",
                "拽 砖专  砖专 转 专转  砖 砖 ",
                "砖专 驻转 拽专 专转 注拽转 转转 注 砖转转 专 爪专",
                " 爪驻 注 砖注转转 专 专  砖 拽专",
                "转 砖驻 注  转 注转专 驻住拽  驻  砖  砖驻",
                "砖专 爪专 爪注 转转 砖 拽转 住 注住拽 拽 ",
                "专  拽专 砖专 驻住 砖 转 砖 转",
                "注 拽爪注转 爪 注 砖 转 专 驻 拽砖砖 住转",
                "爪转 砖专转  驻专住转 专 砖 转 砖专转 砖专转 爪专",
                "砖专 转 住 专 转 转拽转 注  专 专驻 转 ",
                " 拽 注转  砖驻注转 爪驻转 砖 专驻专 爪注转",
                "专砖转 专转 注专 驻转  砖驻  专 砖 驻爪转",
                "专 拽专 住专 砖专  注 驻专爪转 专 砖注转转  拽",
                "注 爪专转 驻专住  拽祝 注 爪 拽专 专 砖专"
            ]
        };

        const translations = {
            easy: [
                { en: "The sun shines in the blue sky", fr: "Le soleil brille dans le ciel bleu" },
                { en: "The children play in the public garden", fr: "Les enfants jouent dans le jardin public" },
                { en: "The dog runs fast in the street", fr: "Le chien court vite dans la rue" },
                { en: "I love eating fresh fruits", fr: "J'aime manger des fruits frais" },
                { en: "The teacher teaches the students", fr: "L'enseignante enseigne aux 茅l猫ves" },
                { en: "The book is on the table", fr: "Le livre est sur la table" },
                { en: "The water is cold and clear", fr: "L'eau est froide et claire" },
                { en: "The tree is tall and very beautiful", fr: "L'arbre est grand et tr猫s beau" },
                { en: "The bird sings in the morning", fr: "L'oiseau chante le matin" },
                { en: "The cat sleeps on the armchair", fr: "Le chat dort sur le fauteuil" },
                { en: "The flowers bloom in spring", fr: "Les fleurs fleurissent au printemps" },
                { en: "Mom cooks a delicious dinner", fr: "Maman cuisine un d茅licieux d卯ner" },
                { en: "Dad reads a newspaper in the living room", fr: "Papa lit un journal dans le salon" },
                { en: "The bus arrives on time at the station", fr: "Le bus arrive  l'heure  la gare" },
                { en: "Our house is big and comfortable", fr: "Notre maison est grande et confortable" },
                { en: "The new car is blue and fast", fr: "La nouvelle voiture est bleue et rapide" },
                { en: "I walk to school on foot", fr: "Je vais  l'茅cole  pied" },
                { en: "The moon shines in the dark night", fr: "La lune brille dans la nuit noire" },
                { en: "The rain falls outside heavily", fr: "La pluie tombe dehors avec force" },
                { en: "My friend lives on the neighboring street", fr: "Mon amie habite dans la rue voisine" }
            ],
            medium: [
                { en: "The new government announced a comprehensive economic plan", fr: "Le nouveau gouvernement a annonc茅 un plan 茅conomique complet" },
                { en: "Scientists discovered a new planet in the solar system", fr: "Les scientifiques ont d茅couvert une nouvelle plan猫te dans le syst猫me solaire" },
                { en: "The weather forecast promises sun and heat on the weekend", fr: "Les pr茅visions m茅t茅o promettent du soleil et de la chaleur ce week-end" },
                { en: "The president met with leaders of neighboring countries", fr: "Le pr茅sident a rencontr茅 les dirigeants des pays voisins" },
                { en: "The Israeli technology company raised millions of dollars", fr: "L'entreprise technologique isra茅lienne a lev茅 des millions de dollars" },
                { en: "Doctors recommend a healthy and active lifestyle", fr: "Les m茅decins recommandent un mode de vie sain et actif" },
                { en: "The city plans to build a new public park downtown", fr: "La ville pr茅voit de construire un nouveau parc public au centre-ville" },
                { en: "Israeli athletes won medals at the Olympics", fr: "Les athl猫tes isra茅liens ont remport茅 des m茅dailles aux Jeux olympiques" },
                { en: "The university is opening a new study program", fr: "L'universit茅 ouvre un nouveau programme d'茅tudes" },
                { en: "The Israeli high-tech industry continues to grow", fr: "L'industrie high-tech isra茅lienne continue de cro卯tre" },
                { en: "Students protest on campus against tuition fee increases", fr: "Les 茅tudiants manifestent sur le campus contre l'augmentation des frais de scolarit茅" },
                { en: "The museum exhibits a new modern art exhibition", fr: "Le mus茅e pr茅sente une nouvelle exposition d'art moderne" },
                { en: "The transportation minister announced expansion of railway lines in the north", fr: "Le ministre des transports a annonc茅 l'expansion des lignes ferroviaires au nord" },
                { en: "Israeli soccer players will compete against the German national team", fr: "Les footballeurs isra茅liens affronteront l'茅quipe nationale allemande" },
                { en: "Families enjoy a family trip in the Judean Desert", fr: "Les familles profitent d'une excursion familiale dans le d茅sert de Jud茅e" },
                { en: "The new store sells electronic products at cheap prices", fr: "Le nouveau magasin vend des produits 茅lectroniques  bas prix" },
                { en: "Tourists visit Jerusalem and Tel Aviv in growing numbers", fr: "Les touristes visitent J茅rusalem et Tel Aviv en nombre croissant" },
                { en: "The manager announced organizational changes in the company", fr: "Le directeur a annonc茅 des changements organisationnels dans l'entreprise" },
                { en: "The photographer won an international award for his outstanding work", fr: "Le photographe a remport茅 un prix international pour son travail exceptionnel" },
                { en: "The annual festival will last three days in the middle of the month", fr: "Le festival annuel durera trois jours au milieu du mois" }
            ],
            hard: [
                { en: "The Knesset approved the controversial bill in first reading yesterday", fr: "La Knesset a approuv茅 hier en premi猫re lecture le projet de loi controvers茅" },
                { en: "The Ministry of Health published new data indicating an increase in patients", fr: "Le minist猫re de la Sant茅 a publi茅 de nouvelles donn茅es indiquant une augmentation des patients" },
                { en: "Negotiations between the parties have continued for three weeks without significant progress", fr: "Les n茅gociations entre les parties se poursuivent depuis trois semaines sans progr猫s significatif" },
                { en: "Researchers at Hebrew University developed innovative technology for treating diseases", fr: "Les chercheurs de l'Universit茅 h茅bra茂que ont d茅velopp茅 une technologie innovante pour traiter les maladies" },
                { en: "The stock exchange ended trading down three percent", fr: "La bourse a termin茅 les 茅changes en baisse de trois pour cent" },
                { en: "The Prime Minister announced the establishment of a state commission of inquiry", fr: "Le Premier ministre a annonc茅 la cr茅ation d'une commission d'enqu锚te d'tat" },
                { en: "The Ministry of Education is planning a comprehensive reform in the Israeli education system", fr: "Le minist猫re de l'ducation planifie une r茅forme compl猫te du syst猫me 茅ducatif isra茅lien" },
                { en: "Bank of Israel decided to keep interest rates unchanged this month", fr: "La Banque d'Isra毛l a d茅cid茅 de maintenir les taux d'int茅r锚t inchang茅s ce mois-ci" },
                { en: "Police launched an extensive investigation following complaints of corruption in the public sector", fr: "La police a lanc茅 une enqu锚te approfondie suite  des plaintes de corruption dans le secteur public" },
                { en: "Experts predict a significant increase in housing prices during the coming year", fr: "Les experts pr茅voient une augmentation significative des prix de l'immobilier au cours de l'ann茅e  venir" }
            ]
        };

        let currentDifficulty = 'easy';
        let currentSentences = [];
        let currentTranslations = [];
        let currentSentenceIndex = 0;
        let currentSentence = '';
        let typedText = '';
        let gameActive = false;
        let startTime = null;
        let totalChars = 0;
        let correctChars = 0;
        let sentencesCompleted = 0;
        let totalScore = 0;
        let wpmHistory = [];

        // Hebrew-English keyboard layout mapping
        const hebrewToEnglishMap = {
            '/': 'q', "'": 'w', '拽': 'e', '专': 'r', '': 't',
            '': 'y', '': 'u', '': 'i', '': 'o', '驻': 'p',
            '砖': 'a', '': 's', '': 'd', '': 'f', '注': 'g',
            '': 'h', '': 'j', '': 'k', '': 'l', '祝': ';',
            '': 'z', '住': 'x', '': 'c', '': 'v', '': 'b',
            '': 'n', '爪': 'm', '转': ',', '抓': '.', '.': '/',
            // Final forms
            '': 'i', '': 'o', '': 'l', '祝': ';', '抓': '.'
        };

        const englishToHebrewMap = {
            'q': '/', 'w': "'", 'e': '拽', 'r': '专', 't': '',
            'y': '', 'u': '', 'i': '', 'o': '', 'p': '驻',
            'a': '砖', 's': '', 'd': '', 'f': '', 'g': '注',
            'h': '', 'j': '', 'k': '', 'l': '', ';': '祝',
            'z': '', 'x': '住', 'c': '', 'v': '', 'b': '',
            'n': '', 'm': '爪', ',': '转', '.': '抓', '/': '.'
        };

        function convertHebrewToEnglish(text) {
            return text.split('').map(char => hebrewToEnglishMap[char] || char).join('');
        }

        function convertEnglishToHebrew(text) {
            return text.split('').map(char => englishToHebrewMap[char.toLowerCase()] || char).join('');
        }

        const typingInput = document.getElementById('typingInput');
        const sentenceDisplay = document.getElementById('sentenceDisplay');
        const englishTranslation = document.getElementById('englishTranslation');
        const frenchTranslation = document.getElementById('frenchTranslation');
        const keyboardHint = document.getElementById('keyboardHint');
        const startBtn = document.getElementById('startBtn');
        const skipBtn = document.getElementById('skipBtn');
        const gameOverScreen = document.getElementById('gameOver');
        const startScreen = document.getElementById('startScreen');

        function selectDifficulty(difficulty) {
            currentDifficulty = difficulty;
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function loadNewSentence() {
            if (currentSentenceIndex >= currentSentences.length) {
                endGame();
                return;
            }

            currentSentence = currentSentences[currentSentenceIndex];
            const translation = currentTranslations[currentSentenceIndex];
            
            englishTranslation.textContent = translation.en;
            frenchTranslation.textContent = translation.fr;
            
            // Show keyboard layout conversion hint
            const englishKeyboardVersion = convertHebrewToEnglish(currentSentence);
            keyboardHint.textContent = `English keyboard: ${englishKeyboardVersion}`;
            
            typedText = '';
            typingInput.value = '';
            startTime = Date.now();
            
            updateSentenceDisplay();
            updateStats();
        }

        function updateSentenceDisplay() {
            let html = '';
            for (let i = 0; i < currentSentence.length; i++) {
                const char = currentSentence[i];
                let className = 'char';
                
                if (i < typedText.length) {
                    className += typedText[i] === char ? ' correct' : ' incorrect';
                } else if (i === typedText.length) {
                    className += ' current';
                }
                
                html += `<span class="${className}">${char}</span>`;
            }
            sentenceDisplay.innerHTML = html;
        }

        function calculateWPM() {
            const timeElapsed = (Date.now() - startTime) / 1000 / 60; // minutes
            const wordsTyped = typedText.length / 5; // standard: 5 chars = 1 word
            return Math.round(wordsTyped / timeElapsed) || 0;
        }

        function calculateAccuracy() {
            if (totalChars === 0) return 100;
            return Math.round((correctChars / totalChars) * 100);
        }

        function updateStats() {
            document.getElementById('sentenceNum').textContent = currentSentenceIndex + 1;
            document.getElementById('accuracy').textContent = calculateAccuracy();
            document.getElementById('wpm').textContent = calculateWPM();
            document.getElementById('score').textContent = totalScore;
            
            const progress = ((currentSentenceIndex) / currentSentences.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = Math.round(progress) + '%';
        }

        function startGame() {
            // Shuffle sentences and translations together
            const indices = Array.from({length: sentences[currentDifficulty].length}, (_, i) => i);
            const shuffledIndices = shuffleArray(indices);
            
            currentSentences = shuffledIndices.map(i => sentences[currentDifficulty][i]);
            currentTranslations = shuffledIndices.map(i => translations[currentDifficulty][i]);
            
            currentSentenceIndex = 0;
            totalChars = 0;
            correctChars = 0;
            sentencesCompleted = 0;
            totalScore = 0;
            wpmHistory = [];
            gameActive = true;
            
            startScreen.classList.add('hidden');
            gameOverScreen.classList.add('hidden');
            typingInput.disabled = false;
            startBtn.disabled = true;
            skipBtn.disabled = false;
            typingInput.focus();
            
            loadNewSentence();
        }

        function skipSentence() {
            currentSentenceIndex++;
            loadNewSentence();
        }

        function endGame() {
            gameActive = false;
            typingInput.disabled = true;
            startBtn.disabled = false;
            skipBtn.disabled = true;
            
            const avgWpm = wpmHistory.length > 0 
                ? Math.round(wpmHistory.reduce((a, b) => a + b, 0) / wpmHistory.length)
                : 0;
            
            document.getElementById('finalSentences').textContent = sentencesCompleted;
            document.getElementById('finalAccuracy').textContent = calculateAccuracy();
            document.getElementById('finalWpm').textContent = avgWpm;
            document.getElementById('finalScore').textContent = totalScore;
            
            gameOverScreen.classList.remove('hidden');
        }

        function resetGame() {
            gameActive = false;
            currentSentenceIndex = 0;
            typedText = '';
            typingInput.value = '';
            typingInput.disabled = true;
            startBtn.disabled = false;
            skipBtn.disabled = true;
            sentenceDisplay.textContent = '抓 "转"  转';
            englishTranslation.textContent = 'Press "Start" to begin';
            frenchTranslation.textContent = 'Appuyez sur "D茅marrer" pour commencer';
            keyboardHint.textContent = '-';
            totalChars = 0;
            correctChars = 0;
            sentencesCompleted = 0;
            totalScore = 0;
            wpmHistory = [];
            updateStats();
        }

        function restartGame() {
            gameOverScreen.classList.add('hidden');
            startScreen.classList.remove('hidden');
        }

        // Handle mobile keyboard opening - scroll sentence into view
        typingInput.addEventListener('focus', () => {
            if (!gameActive) return;
            
            // Small delay to let keyboard animate in
            setTimeout(() => {
                sentenceDisplay.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 300);
        });

        typingInput.addEventListener('input', (e) => {
            if (!gameActive) return;
            
            typedText = e.target.value;
            
            // Check each character
            for (let i = 0; i < typedText.length; i++) {
                if (i >= currentSentence.length) break;
                
                // Only count new characters
                if (i >= totalChars - (currentSentence.length - typedText.length)) {
                    totalChars++;
                    if (typedText[i] === currentSentence[i]) {
                        correctChars++;
                    }
                }
            }
            
            updateSentenceDisplay();
            updateStats();
            
            // Check if sentence is complete
            if (typedText === currentSentence) {
                const wpm = calculateWPM();
                wpmHistory.push(wpm);
                
                // Calculate score for this sentence
                const accuracy = (correctChars / currentSentence.length) * 100;
                const sentenceScore = Math.round(wpm * (accuracy / 100) * (currentDifficulty === 'easy' ? 1 : currentDifficulty === 'medium' ? 1.5 : 2));
                totalScore += sentenceScore;
                
                sentencesCompleted++;
                currentSentenceIndex++;
                
                setTimeout(() => {
                    loadNewSentence();
                }, 500);
            }
        });
    </script>
</body>
</html>

